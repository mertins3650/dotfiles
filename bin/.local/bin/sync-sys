#!/bin/bash

pushd ~/archsetup/
git pull
mapfile -t packages < <(grep -v '^#' ~/archsetup/base.packages)
paru -Syu --noconfirm --needed "${packages[@]}"

popd

pushd ~/dotfiles/
git pull
for dir in */; do
    [ -d "$dir" ] || continue
    dir=${dir%/}
    echo "Stowing $dir..."
    stow --target="$HOME" "$dir"
done
popd
